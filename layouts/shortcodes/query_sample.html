{{- $id := .Get "id" -}}
{{- $description := .Get "description" -}}
{{- $entity := .Get "entity" -}}
{{- $jsQueryMap := .Get "jsQueryMap" -}}
{{- $jsQueryBuilder := .Get "jsQueryBuilder" -}}
{{- $restApi := .Get "restApi" -}}

<style>
    .tab-content > div {
        display: none;
    }

    .tab-content > div.active {
        display: block;
    }
    
    .nav-tabs {
        list-style-type: none;
        padding: 0;
        margin: 0;
    }
    
    .nav-tabs li {
        display: inline-block;
        margin-right: 10px;
    }
    
    .nav-tabs button {
        border: none;
        background-color: lightblue;
        cursor: pointer;
        font-size: 16px;
        padding: 10px;
    }
    
    .nav-tabs button.active {
        font-weight: bold;
        background-color: lightgreen;
    }
</style>

<ul id="query-sample-{{ $id }}" class="nav nav-tabs">
    <li><button onclick="showTab('{{ $id }}', 'jsQueryMap-{{ $id }}')">JS Query Map</button></li>
    <li><button onclick="showTab('{{ $id }}', 'jsQueryBuilder-{{ $id }}')">JS Query Builder</button></li>
    <li><button onclick="showTab('{{ $id }}', 'rest-{{ $id }}')">REST API</button></li>
</ul>
<div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="jsQueryMap-{{ $id }}">
        <div>
            <pre><code>// {{ $description }} 
var records_{{ $id }} = sys.data.find('{{ $entity }}', {{ $jsQueryMap }});
log('total: '+records_{{ $id }}.count());
while (records_{{ $id }}.hasNext()) {
    log(records_{{ $id }}.next().label());
}</code></pre>
        </div>
    </div>
    <div role="tabpanel" class="tab-pane" id="jsQueryBuilder-{{ $id }}">
        <div>
            <pre><code>// {{ $description }} 
var query_{{ $id }} = sys.data.createQuery('{{ $entity }}')
    {{ $jsQueryBuilder }}
var records_{{ $id }} = sys.data.find(query_{{ $id }});
log('total: '+records_{{ $id }}.count());
while (records_{{ $id }}.hasNext()) {
    log(records_{{ $id }}.next().label());
}</code></pre>
        </div>
    </div>
    <div role="tabpanel" class="tab-pane" id="rest-{{ $id }}">
        <div>
            <pre><code>// {{ $description }} 
GET /data/contacts?{{ $restApi }}</code></pre>
        </div>
    </div>
</div>

<script>
    function showTab(id, tabId) {
        var tab = document.getElementById(tabId);
        tab.classList.add('active');
        
        var otherTabs = Array.from(tab.parentNode.children).filter(function(child) {
            return child !== tab;
        });
        
        otherTabs.forEach(function(otherTab) {
            otherTab.classList.remove('active');
        });
    }
</script>
